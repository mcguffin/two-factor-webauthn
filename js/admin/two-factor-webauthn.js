!function(){var e={};(function(n){"use strict";var t,a=(t="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null)&&t.__esModule?t:{default:t};e={register:function(e,n){var t=e.action,r=e.payload,o=e._wpnonce;!function(e,n){(e=JSON.parse(e)).publicKey.attestation=void 0,e.publicKey.challenge=new Uint8Array(e.publicKey.challenge),e.publicKey.user.id=new Uint8Array(e.publicKey.user.id),navigator.credentials.create({publicKey:e.publicKey}).then(function(t){var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t.response.clientDataJSON)));if(e.b64challenge!=a.challenge&&n(!1,"key returned something unexpected (1)"),"https://"+e.publicKey.rp.name!=a.origin)return n(!1,"key returned something unexpected (2)");if(!("type"in a))return n(!1,"key returned something unexpected (3)");if("webauthn.create"!=a.type)return n(!1,"key returned something unexpected (4)");var r=[];new Uint8Array(t.response.attestationObject).forEach(function(e){r.push(e)});var o=[];new Uint8Array(t.rawId).forEach(function(e){o.push(e)});var i={rawId:o,id:t.id,type:t.type,response:{attestationObject:r,clientDataJSON:JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t.response.clientDataJSON)))}};n(!0,JSON.stringify(i))}).catch(function(e){"name"in e&&("AbortError"==e.name||"NS_ERROR_ABORT"==e.name)||"NotAllowedError"==e.name?n(!1,"abort"):n(!1,e.toString())})}(r,function(e,r){a.default.ajax({url:wp.ajax.settings.url,method:"post",data:{action:t,payload:r,_wpnonce:o},success:n})})},login:function(e,n){e.action;var t,a,r,o,i=e.payload;e._wpnonce,t=i,a=function(e,t){n({success:e,result:t})},r=JSON.parse(t),o=r.challenge,r.challenge=new Uint8Array(r.challenge),r.allowCredentials.forEach(function(e,n){r.allowCredentials[n].id=new Uint8Array(e.id)}),navigator.credentials.get({publicKey:r}).then(function(e){var n=[];new Uint8Array(e.rawId).forEach(function(e){n.push(e)});var t=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e.response.clientDataJSON))),r=[];new Uint8Array(e.response.clientDataJSON).forEach(function(e){r.push(e)});var i=[];new Uint8Array(e.response.authenticatorData).forEach(function(e){i.push(e)});var u=[];new Uint8Array(e.response.signature).forEach(function(e){u.push(e)});var l={type:e.type,originalChallenge:o,rawId:n,response:{authenticatorData:i,clientData:t,clientDataJSONarray:r,signature:u}};a(!0,JSON.stringify(l))}).catch(function(e){"name"in e&&("AbortError"==e.name||"NS_ERROR_ABORT"==e.name||"NotAllowedError"==e.name)?a(!1,"abort"):a(!1,e.toString())})},sendRequest:function(e,n){var t=e.action,r=e.payload,o=e._wpnonce;a.default.ajax({url:wp.ajax.settings.url,method:"post",data:{action:t,payload:r,_wpnonce:o},success:n})}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),function(n){"use strict";var t,a=(t="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null)&&t.__esModule?t:{default:t};(0,a.default)(document).on("click","#webauthn-register-key",function(n){n.preventDefault();var t=JSON.parse((0,a.default)(n.target).attr("data-create-options"));(0,e.register)(t,function(e){(0,a.default)("#webauthn-keys").append(e.html)})}),(0,a.default)(document).on("click",".webauthn-action",function(n){var t=JSON.parse((0,a.default)(n.target).attr("data-action")),r=n.target;(0,a.default)(n.target).closest(".webauthn-key"),"webauthn-test-key"===t.action?(n.preventDefault(),(0,e.login)(t,function(e){console.log(e),(0,a.default)(r).append('<span class="dashicons dashicons-yes-alt"></span>')})):"webauthn-delete-key"===t.action&&(n.preventDefault(),(0,e.sendRequest)(t,function(e){e.success&&(0,a.default)(r).closest(".webauthn-key").remove()})),"webauthn-edit-key"===t.action&&"true"!==(0,a.default)(n.currentTarget).prop("contenteditable")&&(n.preventDefault(),function(n,t){var r=t.action,o=t.payload,i=t._wpnonce,u=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],u=(0,a.default)(n).text();(0,a.default)(n).prop("contenteditable",!1),(0,a.default)(document).off("keydown"),(0,a.default)(n).off("blur"),t&&l!==u?((0,a.default)('<span class="spinner"></span>').insertAfter(n),(0,e.sendRequest)({action:r,payload:{md5id:o,label:u},_wpnonce:i},function(e){(0,a.default)(n).next(".spinner").remove()})):t||(0,a.default)(n).text(l)},l=(0,a.default)(n).text();(0,a.default)(n).prop("contenteditable",!0),(0,a.default)(document).on("keydown",function(e){13===e.which?(u(!0),e.preventDefault()):27===e.which&&u(!0)}),(0,a.default)(n).on("blur",function(e){return u(!0)}),document.execCommand("selectAll",!1,null)}(n.currentTarget,t))})}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2stZmxhdC9fcHJlbHVkZSIsInNyYy9qcy9saWIvZGF2aWRlYXJsLXdlYmF1dGhuLmpzIiwic3JjL2pzL2FkbWluL3R3by1mYWN0b3Itd2ViYXV0aG4vaW5kZXguanMiXSwibmFtZXMiOlsiXyRkYXZpZGVhcmxXZWJhdXRobl8yIiwib2JqIiwiX2pxdWVyeSIsIndpbmRvdyIsImpRdWVyeSIsImdsb2JhbCIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwicmVnaXN0ZXIiLCJvcHRzIiwiY2FsbGJhY2siLCJhY3Rpb24iLCJwYXlsb2FkIiwiX3dwbm9uY2UiLCJrZXkiLCJKU09OIiwicGFyc2UiLCJwdWJsaWNLZXkiLCJhdHRlc3RhdGlvbiIsImNoYWxsZW5nZSIsIlVpbnQ4QXJyYXkiLCJ1c2VyIiwiaWQiLCJuYXZpZ2F0b3IiLCJjcmVkZW50aWFscyIsImNyZWF0ZSIsInRoZW4iLCJhTmV3Q3JlZGVudGlhbEluZm8iLCJjZCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImFwcGx5IiwicmVzcG9uc2UiLCJjbGllbnREYXRhSlNPTiIsImI2NGNoYWxsZW5nZSIsInJwIiwibmFtZSIsIm9yaWdpbiIsInR5cGUiLCJhbyIsImF0dGVzdGF0aW9uT2JqZWN0IiwiZm9yRWFjaCIsInYiLCJwdXNoIiwicmF3SWQiLCJpbmZvIiwic3RyaW5naWZ5IiwiY2F0Y2giLCJhRXJyIiwidG9TdHJpbmciLCJzdWNjZXNzIiwiYWpheCIsInVybCIsIndwIiwic2V0dGluZ3MiLCJtZXRob2QiLCJkYXRhIiwibG9naW4iLCJjYiIsInBrIiwib3JpZ2luYWxDaGFsbGVuZ2UiLCJyZXN1bHQiLCJhbGxvd0NyZWRlbnRpYWxzIiwiayIsImlkeCIsImdldCIsImFBc3NlcnRpb24iLCJpZGEiLCJjZGEiLCJhZCIsImF1dGhlbnRpY2F0b3JEYXRhIiwic2lnIiwic2lnbmF0dXJlIiwiY2xpZW50RGF0YSIsImNsaWVudERhdGFKU09OYXJyYXkiLCJzZW5kUmVxdWVzdCIsImRvY3VtZW50Iiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJhdHRyIiwiYXBwZW5kIiwiaHRtbCIsImJ0biIsImNsb3Nlc3QiLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlIiwiY3VycmVudFRhcmdldCIsInByb3AiLCJlZGl0TGFiZWwiLCJzdG9wRWRpdGluZyIsInNhdmUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJuZXdMYWJlbCIsInRleHQiLCJvZmYiLCJwcmV2TGFiZWwiLCJpbnNlcnRBZnRlciIsIm1kNWlkIiwibGFiZWwiLCJuZXh0Iiwid2hpY2giLCJleGVjQ29tbWFuZCJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxJQUFBQSxFQUFBLDZCQ0RBLElBQUFDLEVBQUFDLEdBQUFELEVBQUEsb0JBQUFFLE9BQUFBLE9BQUFDLFlBQUEsSUFBQUMsRUFBQUEsRUFBQUQsT0FBQSxPQUFBSCxFQUFBSyxXQUFBTCxFQUFBLENBQUFNLFFBQUFOLEdBbUtBRCxFQUFpQixDQUNoQlEsU0FsRGdCLFNBQUVDLEVBQU1DLEdBQWMsSUFFOUJDLEVBQThCRixFQUE5QkUsT0FBUUMsRUFBc0JILEVBQXRCRyxRQUFTQyxFQUFhSixFQUFiSSxVQWhFMUIsU0FBMEJDLEVBQUtKLElBQzlCSSxFQUFNQyxLQUFLQyxNQUFNRixJQUNiRyxVQUFVQyxpQkFBQSxFQUNkSixFQUFJRyxVQUFVRSxVQUFZLElBQUlDLFdBQVdOLEVBQUlHLFVBQVVFLFdBQ3ZETCxFQUFJRyxVQUFVSSxLQUFLQyxHQUFLLElBQUlGLFdBQVdOLEVBQUlHLFVBQVVJLEtBQUtDLElBRzFEQyxVQUFVQyxZQUFZQyxPQUFPLENBQUNSLFVBQVdILEVBQUlHLFlBQzNDUyxLQUFLLFNBQVVDLEdBRWYsSUFBSUMsRUFBS2IsS0FBS0MsTUFBTWEsT0FBT0MsYUFBYUMsTUFBTSxLQUFNLElBQUlYLFdBQVdPLEVBQW1CSyxTQUFTQyxrQkFJL0YsR0FISW5CLEVBQUlvQixjQUFnQk4sRUFBR1QsV0FDMUJULEdBQUEsRUFBZ0Is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RSxJQUlkQSxHQUFBLEVBQVlqRyxFQUFBSyxTQUFFb0YsR0FBV00sUUFBQSxFQUUvQi9GLEVBQUFLLFNBQUVvRixHQUFXRCxLQUFNLG1CQUFBLElBQW1CLEVBRXRDeEYsRUFBQUssU0FBRXFFLFVBQVVDLEdBQUksVUFBVyxTQUFBQyxHQUNULEtBQVpBLEVBQUUwQixPQUNOWixHQUFBLEdBQ0FkLEVBQUVDLGtCQUNxQixLQUFaRCxFQUFFMEIsT0FDYlosR0FBQSxNQUFhLEVBS2YxRixFQUFBSyxTQUFFb0YsR0FBV2QsR0FBSSxPQUFRLFNBQUFDLEdBQUMsT0FBSWMsR0FBQSxLQUU5QmhCLFNBQVM2QixZQUFhLGFBQUEsRUFBb0IsTUE5QzNCLENBc0ZKM0IsRUFBRVcsY0FBZWhGLHVIRjNGN0IiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtcbiIsImltcG9ydCAkIGZyb20gJ2pxdWVyeSdcblxuLyoqXG4gKlx0U3RvbGVuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2RhdmlkZWFybC93ZWJhdXRoblxuICovXG5mdW5jdGlvbiB3ZWJhdXRobkF1dGhlbnRpY2F0ZShrZXksIGNiKXtcblx0dmFyIHBrID0gSlNPTi5wYXJzZShrZXkpO1xuXHR2YXIgb3JpZ2luYWxDaGFsbGVuZ2UgPSBway5jaGFsbGVuZ2U7XG5cdHBrLmNoYWxsZW5nZSA9IG5ldyBVaW50OEFycmF5KHBrLmNoYWxsZW5nZSk7XG5cdHBrLmFsbG93Q3JlZGVudGlhbHMuZm9yRWFjaChmdW5jdGlvbihrLCBpZHgpe1xuXHRcdHBrLmFsbG93Q3JlZGVudGlhbHNbaWR4XS5pZCA9IG5ldyBVaW50OEFycmF5KGsuaWQpO1xuXHR9KTtcblx0LyogYXNrIHRoZSBicm93c2VyIHRvIHByb21wdCB0aGUgdXNlciAqL1xuXHRuYXZpZ2F0b3IuY3JlZGVudGlhbHMuZ2V0KHtwdWJsaWNLZXk6IHBrfSlcblx0XHQudGhlbihmdW5jdGlvbihhQXNzZXJ0aW9uKSB7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIkNyZWRlbnRpYWxzLkdldCByZXNwb25zZTogXCIsIGFBc3NlcnRpb24pO1xuXHRcdFx0dmFyIGlkYSA9IFtdO1xuXHRcdFx0KG5ldyBVaW50OEFycmF5KGFBc3NlcnRpb24ucmF3SWQpKS5mb3JFYWNoKGZ1bmN0aW9uKHYpeyBpZGEucHVzaCh2KTsgfSk7XG5cdFx0XHR2YXIgY2QgPSBKU09OLnBhcnNlKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgIG5ldyBVaW50OEFycmF5KGFBc3NlcnRpb24ucmVzcG9uc2UuY2xpZW50RGF0YUpTT04pKSk7XG5cdFx0XHR2YXIgY2RhID0gW107XG5cdFx0XHQobmV3IFVpbnQ4QXJyYXkoYUFzc2VydGlvbi5yZXNwb25zZS5jbGllbnREYXRhSlNPTikpLmZvckVhY2goZnVuY3Rpb24odil7IGNkYS5wdXNoKHYpOyB9KTtcblx0XHRcdHZhciBhZCA9IFtdO1xuXHRcdFx0KG5ldyBVaW50OEFycmF5KGFBc3NlcnRpb24ucmVzcG9uc2UuYXV0aGVudGljYXRvckRhdGEpKS5mb3JFYWNoKGZ1bmN0aW9uKHYpeyBhZC5wdXNoKHYpOyB9KTtcblx0XHRcdHZhciBzaWcgPSBbXTtcblx0XHRcdChuZXcgVWludDhBcnJheShhQXNzZXJ0aW9uLnJlc3BvbnNlLnNpZ25hdHVyZSkpLmZvckVhY2goZnVuY3Rpb24odil7IHNpZy5wdXNoKHYpOyB9KTtcblx0XHRcdHZhciBpbmZvID0ge1xuXHRcdFx0XHR0eXBlOiBhQXNzZXJ0aW9uLnR5cGUsXG5cdFx0XHRcdG9yaWdpbmFsQ2hhbGxlbmdlOiBvcmlnaW5hbENoYWxsZW5nZSxcblx0XHRcdFx0cmF3SWQ6IGlkYSxcblx0XHRcdFx0cmVzcG9uc2U6IHtcblx0XHRcdFx0XHRhdXRoZW50aWNhdG9yRGF0YTogYWQsXG5cdFx0XHRcdFx0Y2xpZW50RGF0YTogY2QsXG5cdFx0XHRcdFx0Y2xpZW50RGF0YUpTT05hcnJheTogY2RhLFxuXHRcdFx0XHRcdHNpZ25hdHVyZTogc2lnXG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHRjYih0cnVlLCBKU09OLnN0cmluZ2lmeShpbmZvKSk7XG5cdFx0fSlcblx0XHQuY2F0Y2goZnVuY3Rpb24gKGFFcnIpIHtcblx0XHRcdGlmICgoXCJuYW1lXCIgaW4gYUVycikgJiYgKGFFcnIubmFtZSA9PSBcIkFib3J0RXJyb3JcIiB8fCBhRXJyLm5hbWUgPT0gXCJOU19FUlJPUl9BQk9SVFwiIHx8XG5cdFx0XHRcdFx0XHRcdFx0XHQgYUVyci5uYW1lID09IFwiTm90QWxsb3dlZEVycm9yXCIpKSB7XG5cdFx0XHRcdGNiKGZhbHNlLCAnYWJvcnQnKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNiKGZhbHNlLCBhRXJyLnRvU3RyaW5nKCkpO1xuXHRcdFx0fVxuXHRcdH0pO1xufVxuXG4vKipcbiAqXHRTdG9sZW4gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vZGF2aWRlYXJsL3dlYmF1dGhuXG4gKi9cbmZ1bmN0aW9uIHdlYmF1dGhuUmVnaXN0ZXIoa2V5LCBjYWxsYmFjayl7XG5cdGtleSA9IEpTT04ucGFyc2Uoa2V5KTtcblx0a2V5LnB1YmxpY0tleS5hdHRlc3RhdGlvbiA9IHVuZGVmaW5lZDtcblx0a2V5LnB1YmxpY0tleS5jaGFsbGVuZ2UgPSBuZXcgVWludDhBcnJheShrZXkucHVibGljS2V5LmNoYWxsZW5nZSk7IC8vIGNvbnZlcnQgdHlwZSBmb3IgdXNlIGJ5IGtleVxuXHRrZXkucHVibGljS2V5LnVzZXIuaWQgPSBuZXcgVWludDhBcnJheShrZXkucHVibGljS2V5LnVzZXIuaWQpO1xuXG5cdC8vIGNvbnNvbGUubG9nKGtleSk7XG5cdG5hdmlnYXRvci5jcmVkZW50aWFscy5jcmVhdGUoe3B1YmxpY0tleToga2V5LnB1YmxpY0tleX0pXG5cdFx0LnRoZW4oZnVuY3Rpb24gKGFOZXdDcmVkZW50aWFsSW5mbykge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJDcmVkZW50aWFscy5DcmVhdGUgcmVzcG9uc2U6IFwiLCBhTmV3Q3JlZGVudGlhbEluZm8pO1xuXHRcdFx0dmFyIGNkID0gSlNPTi5wYXJzZShTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KGFOZXdDcmVkZW50aWFsSW5mby5yZXNwb25zZS5jbGllbnREYXRhSlNPTikpKTtcblx0XHRcdGlmIChrZXkuYjY0Y2hhbGxlbmdlICE9IGNkLmNoYWxsZW5nZSkge1xuXHRcdFx0XHRjYWxsYmFjayhmYWxzZSwgJ2tleSByZXR1cm5lZCBzb21ldGhpbmcgdW5leHBlY3RlZCAoMSknKTtcblx0XHRcdH1cblx0XHRcdGlmICgnaHR0cHM6Ly8nK2tleS5wdWJsaWNLZXkucnAubmFtZSAhPSBjZC5vcmlnaW4pIHtcblx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKGZhbHNlLCAna2V5IHJldHVybmVkIHNvbWV0aGluZyB1bmV4cGVjdGVkICgyKScpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCEgKCd0eXBlJyBpbiBjZCkpIHtcblx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKGZhbHNlLCAna2V5IHJldHVybmVkIHNvbWV0aGluZyB1bmV4cGVjdGVkICgzKScpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGNkLnR5cGUgIT0gJ3dlYmF1dGhuLmNyZWF0ZScpIHtcblx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKGZhbHNlLCAna2V5IHJldHVybmVkIHNvbWV0aGluZyB1bmV4cGVjdGVkICg0KScpO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgYW8gPSBbXTtcblx0XHRcdChuZXcgVWludDhBcnJheShhTmV3Q3JlZGVudGlhbEluZm8ucmVzcG9uc2UuYXR0ZXN0YXRpb25PYmplY3QpKS5mb3JFYWNoKGZ1bmN0aW9uKHYpe1xuXHRcdFx0XHRhby5wdXNoKHYpO1xuXHRcdFx0fSk7XG5cdFx0XHR2YXIgcmF3SWQgPSBbXTtcblx0XHRcdChuZXcgVWludDhBcnJheShhTmV3Q3JlZGVudGlhbEluZm8ucmF3SWQpKS5mb3JFYWNoKGZ1bmN0aW9uKHYpe1xuXHRcdFx0XHRyYXdJZC5wdXNoKHYpO1xuXHRcdFx0fSk7XG5cdFx0XHR2YXIgaW5mbyA9IHtcblx0XHRcdFx0cmF3SWQ6IHJhd0lkLFxuXHRcdFx0XHRpZDogYU5ld0NyZWRlbnRpYWxJbmZvLmlkLFxuXHRcdFx0XHR0eXBlOiBhTmV3Q3JlZGVudGlhbEluZm8udHlwZSxcblx0XHRcdFx0cmVzcG9uc2U6IHtcblx0XHRcdFx0XHRhdHRlc3RhdGlvbk9iamVjdDogYW8sXG5cdFx0XHRcdFx0Y2xpZW50RGF0YUpTT046XG5cdFx0XHRcdFx0ICBKU09OLnBhcnNlKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkoYU5ld0NyZWRlbnRpYWxJbmZvLnJlc3BvbnNlLmNsaWVudERhdGFKU09OKSkpXG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHRjYWxsYmFjayh0cnVlLCBKU09OLnN0cmluZ2lmeShpbmZvKSk7XG5cdFx0fSlcblx0XHQuY2F0Y2goZnVuY3Rpb24gKGFFcnIpIHtcblx0XHRcdGlmIChcblx0XHRcdFx0KFwibmFtZVwiIGluIGFFcnIpICYmIChhRXJyLm5hbWUgPT0gXCJBYm9ydEVycm9yXCIgfHwgYUVyci5uYW1lID09IFwiTlNfRVJST1JfQUJPUlRcIilcblx0XHRcdFx0fHwgYUVyci5uYW1lID09ICdOb3RBbGxvd2VkRXJyb3InXG5cdFx0XHQpIHtcblx0XHRcdFx0Y2FsbGJhY2soZmFsc2UsICdhYm9ydCcpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FsbGJhY2soZmFsc2UsIGFFcnIudG9TdHJpbmcoKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG59XG5cbi8qKlxuICpcdEBwYXJhbSBBcnJheUJ1ZmZlciBhcnJheUJ1ZlxuICpcdEByZXR1cm4gQXJyYXlcbiAqL1xuY29uc3QgYnVmZmVyMkFycmF5ID0gYXJyYXlCdWYgPT4gWyAuLi4gKG5ldyBVaW50OEFycmF5KCBhcnJheUJ1ZiApKSBdO1xuXG5jb25zdCByZWdpc3RlciA9ICggb3B0cywgY2FsbGJhY2sgKSA9PiB7XG5cblx0Y29uc3QgeyBhY3Rpb24sIHBheWxvYWQsIF93cG5vbmNlIH0gPSBvcHRzO1xuXG5cdHdlYmF1dGhuUmVnaXN0ZXIoIHBheWxvYWQsIChzdWNjZXNzLGluZm8pID0+IHtcblx0XHQkLmFqYXgoe1xuXHRcdFx0dXJsOiB3cC5hamF4LnNldHRpbmdzLnVybCxcblx0XHRcdG1ldGhvZDogJ3Bvc3QnLFxuXHRcdFx0ZGF0YToge1xuXHRcdFx0XHRhY3Rpb246IGFjdGlvbixcblx0XHRcdFx0cGF5bG9hZDogaW5mbyxcblx0XHRcdFx0X3dwbm9uY2U6IF93cG5vbmNlXG5cdFx0XHR9LFxuXHRcdFx0c3VjY2VzczogY2FsbGJhY2tcblx0XHR9KVxuXHR9KVxufVxuXG5cbmNvbnN0IGxvZ2luID0gKCBvcHRzLCBjYWxsYmFjayApID0+IHtcblxuXHRjb25zdCB7IGFjdGlvbiwgcGF5bG9hZCwgX3dwbm9uY2UgfSA9IG9wdHM7XG5cblx0d2ViYXV0aG5BdXRoZW50aWNhdGUoIHBheWxvYWQsIChzdWNjZXNzLGluZm8pID0+IHtcblx0XHRjYWxsYmFjayggeyBzdWNjZXNzLCByZXN1bHQ6IGluZm8gfSApXG5cdH0pXG59XG5cbmNvbnN0IHNlbmRSZXF1ZXN0ID0gKCBvcHRzLCBjYWxsYmFjayApID0+IHtcblxuXHRjb25zdCB7IGFjdGlvbiwgcGF5bG9hZCwgX3dwbm9uY2UgfSA9IG9wdHM7XG5cblx0JC5hamF4KHtcblx0XHR1cmw6IHdwLmFqYXguc2V0dGluZ3MudXJsLFxuXHRcdG1ldGhvZDogJ3Bvc3QnLFxuXHRcdGRhdGE6IHtcblx0XHRcdGFjdGlvbjogYWN0aW9uLFxuXHRcdFx0cGF5bG9hZDogcGF5bG9hZCxcblx0XHRcdF93cG5vbmNlOiBfd3Bub25jZVxuXHRcdH0sXG5cdFx0c3VjY2VzczpjYWxsYmFja1xuXHR9KVxufVxuXG5cbmNvbnN0IGVkaXRLZXkgPSAoIG9wdHMsIGNhbGxiYWNrICkgPT4ge1xuXG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXHRyZWdpc3RlciwgbG9naW4sIHNlbmRSZXF1ZXN0XG59XG4iLCJpbXBvcnQgJCBmcm9tICdqcXVlcnknXG5pbXBvcnQgeyByZWdpc3RlciwgbG9naW4sIHNlbmRSZXF1ZXN0IH0gZnJvbSAnZGF2aWRlYXJsLXdlYmF1dGhuJ1xuXG5cblxuY29uc3QgZWRpdEtleSA9ICggZWRpdExhYmVsLCBvcHRzICkgPT4ge1xuXG5cdGNvbnN0IHsgYWN0aW9uLCBwYXlsb2FkLCBfd3Bub25jZSB9ID0gb3B0c1xuXG5cblx0Ly8gY29uc29sZS5sb2coJGVkaXRMYWJlbC5wcm9wKCAnY29udGVudGVkaXRhYmxlJyApKTtcblx0Y29uc3Qgc3RvcEVkaXRpbmcgPSAoIHNhdmUgPSBmYWxzZSApID0+IHtcblx0XHRsZXQgbmV3TGFiZWwgPSAkKGVkaXRMYWJlbCkudGV4dCgpXG5cdFx0JChlZGl0TGFiZWwpLnByb3AoICdjb250ZW50ZWRpdGFibGUnLCBmYWxzZSApO1xuXHRcdCQoZG9jdW1lbnQpLm9mZiggJ2tleWRvd24nIClcblx0XHQkKGVkaXRMYWJlbCkub2ZmKCAnYmx1cicgKVxuXHRcdGlmICggc2F2ZSAmJiBwcmV2TGFiZWwgIT09IG5ld0xhYmVsICkge1xuXG5cdFx0XHQkKCc8c3BhbiBjbGFzcz1cInNwaW5uZXJcIj48L3NwYW4+JykuaW5zZXJ0QWZ0ZXIoZWRpdExhYmVsKVxuXG5cdFx0XHRzZW5kUmVxdWVzdChcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGFjdGlvbixcblx0XHRcdFx0XHRwYXlsb2FkOiB7IG1kNWlkOiBwYXlsb2FkLCBsYWJlbDogbmV3TGFiZWwgfSxcblx0XHRcdFx0XHRfd3Bub25jZVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRyZXNwb25zZSA9PiB7XG5cdFx0XHRcdFx0JChlZGl0TGFiZWwpLm5leHQoJy5zcGlubmVyJykucmVtb3ZlKClcblx0XHRcdFx0fVxuXHRcdFx0KTtcblx0XHR9IGVsc2UgaWYgKCAhIHNhdmUgKSB7XG5cdFx0XHQkKGVkaXRMYWJlbCkudGV4dChwcmV2TGFiZWwpXG5cdFx0fVxuXHR9XG5cblx0Y29uc3QgcHJldkxhYmVsID0gJChlZGl0TGFiZWwpLnRleHQoKVxuXG5cdCQoZWRpdExhYmVsKS5wcm9wKCAnY29udGVudGVkaXRhYmxlJywgdHJ1ZSApO1xuXG5cdCQoZG9jdW1lbnQpLm9uKCAna2V5ZG93bicsIGUgPT4ge1xuXHRcdGlmICggZS53aGljaCA9PT0gMTMgKSB7XG5cdFx0XHRzdG9wRWRpdGluZyggdHJ1ZSApXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KClcblx0XHR9IGVsc2UgaWYgKCBlLndoaWNoID09PSAyNyApIHtcblx0XHRcdHN0b3BFZGl0aW5nKCB0cnVlIClcblx0XHR9XG5cdH0gKVxuXG5cdC8vIGZvY3VzIGFuZCBzZWxlY3Rcblx0JChlZGl0TGFiZWwpLm9uKCAnYmx1cicsIGUgPT4gc3RvcEVkaXRpbmcoIHRydWUgKSApXG5cblx0ZG9jdW1lbnQuZXhlY0NvbW1hbmQoICdzZWxlY3RBbGwnLCBmYWxzZSwgbnVsbCApO1xuXG59XG5cbiQoZG9jdW1lbnQpLm9uKCAnY2xpY2snLCAnI3dlYmF1dGhuLXJlZ2lzdGVyLWtleScsIGUgPT4ge1xuXG5cdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRjb25zdCBvcHRzID0gSlNPTi5wYXJzZSggJChlLnRhcmdldCkuYXR0cignZGF0YS1jcmVhdGUtb3B0aW9ucycpICk7XG5cblx0cmVnaXN0ZXIoIG9wdHMsIHJlc3BvbnNlID0+IHtcblx0XHQkKCcjd2ViYXV0aG4ta2V5cycpLmFwcGVuZChyZXNwb25zZS5odG1sKVxuXHR9KTtcblxufSk7XG5cbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsJy53ZWJhdXRobi1hY3Rpb24nLCBlID0+IHtcblx0Y29uc3Qgb3B0cyA9IEpTT04ucGFyc2UoICQoZS50YXJnZXQpLmF0dHIoJ2RhdGEtYWN0aW9uJykgKTtcblx0Y29uc3QgYnRuID0gZS50YXJnZXQ7XG5cdGNvbnN0ICRrZXlFbCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJy53ZWJhdXRobi1rZXknKVxuXG5cdGlmICggb3B0cy5hY3Rpb24gPT09ICd3ZWJhdXRobi10ZXN0LWtleScgKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGxvZ2luKCBvcHRzLCBmdW5jdGlvbiggcmVzcG9uc2UgKSB7XG5cdFx0XHQvLyBzZW5kIHRoYXQgY3JhcCB0byBzZXJ2ZXJcblx0XHRcdGNvbnNvbGUubG9nKHJlc3BvbnNlKVxuXHRcdFx0JChidG4pLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJkYXNoaWNvbnMgZGFzaGljb25zLXllcy1hbHRcIj48L3NwYW4+Jylcblx0XHR9ICk7XG5cdH0gZWxzZSBpZiAoIG9wdHMuYWN0aW9uID09PSAnd2ViYXV0aG4tZGVsZXRlLWtleScgKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHNlbmRSZXF1ZXN0KCBvcHRzLCBmdW5jdGlvbiggcmVzcG9uc2UgKSB7XG5cdFx0XHQvLyByZW1vdmVcblx0XHRcdGlmICggcmVzcG9uc2Uuc3VjY2VzcyApIHtcblxuXHRcdFx0XHQkKGJ0bikuY2xvc2VzdCgnLndlYmF1dGhuLWtleScpLnJlbW92ZSgpO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSBpZiAoIG9wdHMuYWN0aW9uID09PSAnd2ViYXV0aG4tZWRpdC1rZXknICkge1xuXHRcdGlmICggJ3RydWUnICE9PSAkKGUuY3VycmVudFRhcmdldCkucHJvcCggJ2NvbnRlbnRlZGl0YWJsZScgKSApIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGVkaXRLZXkoIGUuY3VycmVudFRhcmdldCwgb3B0cyApO1xuXHRcdH1cblx0fVxufSk7XG4iXX0=